#!/bin/bash
# llm-interactive - Wrapper script for interactive LLM sessions in Docker.
set -e

# Check if docker-compose is available
if ! command -v docker-compose &> /dev/null; then
    if ! command -v docker compose &> /dev/null; then # Check for 'docker compose' (v2)
        echo "Error: docker-compose (or docker compose) is required but not found."
        echo "Please install Docker Desktop or Docker Engine with Compose plugin."
        exit 1
    fi
    COMPOSE_CMD="docker compose"
else
    COMPOSE_CMD="docker-compose"
fi

SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" &> /dev/null && pwd )"
PROJECT_ROOT="$(dirname "$SCRIPT_DIR")"

if [ ! -f "${PROJECT_ROOT}/docker-compose.yml" ]; then
    echo "Error: docker-compose.yml not found in ${PROJECT_ROOT}."
    echo "Please run this script from within the project directory or ensure the paths are correct."
    exit 1
fi

# Echo "Starting interactive LLM session in Docker..."
# The -it flags are for interactive terminal.
# --rm ensures the container is removed after exiting the bash session.
# 'bash' is specified as the command to run inside the container for an interactive shell.
(cd "$PROJECT_ROOT" && $COMPOSE_CMD run --rm -it llm bash)
